<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><title>ERP System</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { background:#0a0a0f; color:#e2e8f0; font-family:'Segoe UI',sans-serif; }
.header { background:#111827; border-bottom:1px solid #1e293b; padding:1rem 1.5rem; display:flex; align-items:center; justify-content:space-between; }
.header h1 { font-size:1.1rem; font-weight:700; }
.tabs { display:flex; gap:0; border-bottom:1px solid #1e293b; background:#111827; }
.tab { padding:0.75rem 1.5rem; cursor:pointer; font-size:0.82rem; color:#64748b; border-bottom:2px solid transparent; transition:all 0.15s; }
.tab.active { color:#3b82f6; border-bottom-color:#3b82f6; }
#content { padding:1.5rem; }
table { width:100%; border-collapse:collapse; font-size:0.82rem; }
th { text-align:left; padding:0.5rem 0.75rem; font-size:0.68rem; color:#64748b; text-transform:uppercase; letter-spacing:0.06em; border-bottom:1px solid #1e293b; }
td { padding:0.6rem 0.75rem; border-bottom:1px solid #1e293b22; vertical-align:middle; }
tr:hover td { background:#1e293b22; }
.stock-bar { height:6px; border-radius:3px; background:#1e293b; overflow:hidden; width:80px; }
.stock-fill { height:100%; border-radius:3px; }
.badge { padding:0.2rem 0.6rem; border-radius:12px; font-size:0.65rem; font-weight:600; text-transform:uppercase; }
.badge-delivered { background:#14532d30; color:#4ade80; }
.badge-approved { background:#1e3a5f; color:#60a5fa; }
.badge-pending { background:#1f2937; color:#9ca3af; }
.emp-card { display:inline-block; background:#1e293b; border-radius:8px; padding:0.75rem 1rem; margin:0.4rem; min-width:180px; vertical-align:top; }
.emp-name { font-weight:600; font-size:0.88rem; }
.emp-role { font-size:0.72rem; color:#64748b; margin:0.2rem 0; }
.emp-salary { font-size:0.85rem; color:#22c55e; font-weight:600; }
.dept-badge { font-size:0.65rem; padding:0.15rem 0.5rem; border-radius:10px; background:#1e293b; color:#94a3b8; border:1px solid #334155; }
</style>
</head>
<body>
<div class="header">
  <h1>HW-ERP Enterprise Resource Planning</h1>
  <span style="color:#64748b;font-size:0.75rem;" id="erp-summary">Loading...</span>
</div>
<div class="tabs">
  <div class="tab active" data-tab="inventory">Inventory</div>
  <div class="tab" data-tab="po">Purchase Orders</div>
  <div class="tab" data-tab="employees">Employees</div>
</div>
<div id="content">
  <div id="inventory-tab">
    <table>
      <thead><tr><th>SKU</th><th>Name</th><th>Category</th><th>Stock</th><th>Stock Level</th><th>Reorder At</th><th>Unit Cost</th></tr></thead>
      <tbody id="inventory-body"></tbody>
    </table>
  </div>
  <div id="po-tab" style="display:none">
    <table>
      <thead><tr><th>ID</th><th>Vendor</th><th>Status</th><th>Total</th><th>Date</th></tr></thead>
      <tbody id="po-body"></tbody>
    </table>
  </div>
  <div id="employees-tab" style="display:none">
    <div id="emp-grid"></div>
  </div>
</div>
<script>
function fmtCurrency(v) { return '$' + Number(v).toLocaleString(); }
function fmtDate(ts) { return new Date(ts).toLocaleDateString(); }

async function fetchInventory() {
  const items = await fetch('/api/inventory').then(r => r.json());
  const lowStock = items.filter(i => i.qty <= i.reorder_point).length;
  document.getElementById('erp-summary').textContent = items.length + ' items | ' + lowStock + ' low stock';
  document.getElementById('inventory-body').innerHTML = items.map(i => {
    const pct = Math.min(100, Math.round((i.qty / Math.max(i.reorder_point * 3, i.qty)) * 100));
    const color = i.qty <= i.reorder_point ? '#ef4444' : i.qty <= i.reorder_point * 1.5 ? '#f59e0b' : '#22c55e';
    return '<tr>' +
      '<td style="font-family:monospace;color:#64748b;">' + i.sku + '</td>' +
      '<td style="font-weight:600;">' + i.name + '</td>' +
      '<td><span style="font-size:0.72rem;color:#94a3b8;">' + i.category + '</span></td>' +
      '<td style="font-weight:700;color:' + color + ';">' + i.qty + '</td>' +
      '<td><div class="stock-bar"><div class="stock-fill" style="width:' + pct + '%;background:' + color + ';"></div></div></td>' +
      '<td style="color:#64748b;font-size:0.78rem;">' + i.reorder_point + '</td>' +
      '<td>' + fmtCurrency(i.cost) + '</td>' +
      '</tr>';
  }).join('');
}

async function fetchPOs() {
  const pos = await fetch('/api/purchase-orders').then(r => r.json());
  document.getElementById('po-body').innerHTML = pos.map(p =>
    '<tr>' +
    '<td style="font-family:monospace;color:#64748b;">#' + p.id + '</td>' +
    '<td style="font-weight:600;">' + p.vendor + '</td>' +
    '<td><span class="badge badge-' + p.status + '">' + p.status + '</span></td>' +
    '<td style="color:#22c55e;font-weight:700;">' + fmtCurrency(p.total) + '</td>' +
    '<td style="color:#64748b;font-size:0.78rem;">' + fmtDate(p.created_at) + '</td>' +
    '</tr>'
  ).join('');
}

async function fetchEmployees() {
  const emps = await fetch('/api/employees').then(r => r.json());
  const depts = [...new Set(emps.map(e => e.dept))];
  const deptColors = { Engineering:'#1e3a5f', Product:'#2d1b69', Design:'#1a1f4e', Marketing:'#451a03', Sales:'#14532d', Finance:'#1c1917', HR:'#1f2937', Operations:'#1e293b' };
  document.getElementById('emp-grid').innerHTML = depts.map(dept => {
    const deptEmps = emps.filter(e => e.dept === dept);
    const color = deptColors[dept] || '#1e293b';
    return '<div style="margin-bottom:1.5rem;">' +
      '<div style="font-size:0.72rem;color:#64748b;text-transform:uppercase;letter-spacing:0.06em;margin-bottom:0.5rem;">' + dept + ' (' + deptEmps.length + ')</div>' +
      deptEmps.map(e =>
        '<div class="emp-card" style="border-left:3px solid;border-left-color:' + (color.includes('3a5f') ? '#60a5fa' : color.includes('1b69') ? '#a78bfa' : '#22c55e') + ';">' +
        '<div class="emp-name">' + e.name + '</div>' +
        '<div class="emp-role">' + e.role + '</div>' +
        '<div class="emp-salary">' + fmtCurrency(e.salary) + '/yr</div>' +
        '</div>'
      ).join('') +
      '</div>';
  }).join('');
}

document.querySelectorAll('.tab').forEach(t => {
  t.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
    t.classList.add('active');
    const tab = t.dataset.tab;
    document.getElementById('inventory-tab').style.display = tab === 'inventory' ? '' : 'none';
    document.getElementById('po-tab').style.display = tab === 'po' ? '' : 'none';
    document.getElementById('employees-tab').style.display = tab === 'employees' ? '' : 'none';
  });
});

fetchInventory();
fetchPOs();
fetchEmployees();
setInterval(fetchInventory, 3000);
</script>
</body>
</html>
